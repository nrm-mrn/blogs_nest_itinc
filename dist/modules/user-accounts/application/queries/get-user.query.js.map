{"version":3,"sources":["../../../../../src/modules/user-accounts/application/queries/get-user.query.ts"],"sourcesContent":["import { IQueryHandler, QueryHandler } from '@nestjs/cqrs';\nimport { User, UserModelType } from '../../domain/user.entity';\nimport { InjectModel } from '@nestjs/mongoose';\nimport { UserViewDto } from '../../api/view-dto/users.view-dto';\nimport { DomainExceptionCode } from 'src/core/exceptions/domain-exception-codes';\nimport { DomainException } from 'src/core/exceptions/domain-exceptions';\n\nexport class GetUserQuery {\n  constructor(public userId: string) {}\n}\n\n@QueryHandler(GetUserQuery)\nexport class GetUserQueryHandler\n  implements IQueryHandler<GetUserQuery, UserViewDto>\n{\n  constructor(\n    @InjectModel(User.name) private readonly UserModel: UserModelType,\n  ) {}\n\n  async execute(query: GetUserQuery): Promise<UserViewDto> {\n    const user = await this.UserModel.findOne({\n      _id: query.userId,\n      deletedAt: null,\n    }).orFail(\n      new DomainException({\n        code: DomainExceptionCode.InternalServerError,\n        message: 'User not found after creation',\n      }),\n    );\n    return {\n      id: user._id.toString(),\n      login: user.login,\n      email: user.email,\n      createdAt: user.createdAt.toISOString(),\n    };\n  }\n}\n"],"names":["GetUserQuery","GetUserQueryHandler","constructor","userId","execute","query","user","UserModel","findOne","_id","deletedAt","orFail","DomainException","code","DomainExceptionCode","InternalServerError","message","id","toString","login","email","createdAt","toISOString","name"],"mappings":";;;;;;;;;;;QAOaA;eAAAA;;QAKAC;eAAAA;;;sBAZ+B;4BACR;0BACR;sCAEQ;kCACJ;;;;;;;;;;;;;;;AAEzB,IAAA,AAAMD,eAAN,MAAMA;IACXE,YAAY,AAAOC,MAAc,CAAE;aAAhBA,SAAAA;IAAiB;AACtC;AAGO,IAAA,AAAMF,sBAAN,MAAMA;IAOX,MAAMG,QAAQC,KAAmB,EAAwB;QACvD,MAAMC,OAAO,MAAM,IAAI,CAACC,SAAS,CAACC,OAAO,CAAC;YACxCC,KAAKJ,MAAMF,MAAM;YACjBO,WAAW;QACb,GAAGC,MAAM,CACP,IAAIC,iCAAe,CAAC;YAClBC,MAAMC,yCAAmB,CAACC,mBAAmB;YAC7CC,SAAS;QACX;QAEF,OAAO;YACLC,IAAIX,KAAKG,GAAG,CAACS,QAAQ;YACrBC,OAAOb,KAAKa,KAAK;YACjBC,OAAOd,KAAKc,KAAK;YACjBC,WAAWf,KAAKe,SAAS,CAACC,WAAW;QACvC;IACF;IApBApB,YACE,AAAyCK,SAAwB,CACjE;aADyCA,YAAAA;IACxC;AAmBL;;;6DApBsBgB"}